[
  // File Explorer
  { "key": "a", "command": "explorer.newFile", "when": "explorerViewletVisible && filesExplorerFocus && !explorerResourceIsRoot && !explorerResourceReadonly && !inputFocus" },
  { "key": "shift+a", "command": "explorer.newFolder", "when": "explorerViewletVisible && filesExplorerFocus && !explorerResourceIsRoot && !explorerResourceReadonly && !inputFocus" },
  { "key": "d d", "command": "moveFileToTrash", "when": "explorerViewletVisible && filesExplorerFocus && !explorerResourceIsRoot && !explorerResourceReadonly && !inputFocus" },
  { "key": "r", "command": "renameFile", "when": "explorerViewletVisible && filesExplorerFocus && !explorerResourceIsRoot && !explorerResourceReadonly && !inputFocus" },
  {
    "key": "e",
    "command": "whichkey.triggerKey",
    "args": {
      "key": "e",
      "when": "sideBarVisible && explorerViewletVisible"
    },
    "when": "whichkeyVisible && sideBarVisible && explorerViewletVisible"
  },
  // { "key": "space", "command": "filesExplorer.openFilePreserveFocus", "when": "explorerViewletVisible && filesExplorerFocus && !explorerResourceIsFolder && !inputFocus" },
  // { "key": "enter", "command": "explorer.openAndPassFocus", "when": "explorerViewletVisible && filesExplorerFocus && !explorerResourceIsFolder && !inputFocus" },
  { "key": "h", "command": "list.collapse", "when": "listFocus && !inputFocus" },
  { "key": "o", "command": "list.select", "when": "listFocus && !inputFocus" },
  {
    "key": "Left",
    "command": "list.collapse",
    "when": "listFocus && !inputFocus"
  },
  {
    "key": "Right",
    "command": "list.select",
    "when": "listFocus && !inputFocus"
  },
  {
    "key": "Down",
    "command": "vim.remap",
    "args": {
      "commands": [
        { "command": "list.focusDown" },
        { "command": "filesExplorer.openFilePreserveFocus" },
      ]
    },
    "when": "listFocus && !inputFocus"
  },
  {
    "key": "Up",
    "command": "vim.remap",
    "args": {
      "commands": [
        { "command": "list.focusUp" },
        { "command": "filesExplorer.openFilePreserveFocus" },
      ]
    },
    "when": "listFocus && !inputFocus"
  },
  {
    "key": "shift+j",
    "command": "vim.remap",
    "args": {
      "commands": [
        { "command": "list.focusDown" },
        { "command": "list.focusDown" },
        { "command": "list.focusDown" },
        { "command": "list.focusDown" },
        { "command": "list.focusDown" },
        { "command": "list.focusDown" },
        { "command": "list.focusDown" },
        { "command": "list.focusDown" },
        { "command": "list.focusDown" },
        { "command": "list.focusDown" },
      ]
    },
    "when": "listFocus && !inputFocus"
  },
  {
    "key": "shift+k",
    "command": "vim.remap",
    "args": {
      "commands": [
        { "command": "list.focusUp" },
        { "command": "list.focusUp" },
        { "command": "list.focusUp" },
        { "command": "list.focusUp" },
        { "command": "list.focusUp" },
        { "command": "list.focusUp" },
        { "command": "list.focusUp" },
        { "command": "list.focusUp" },
        { "command": "list.focusUp" },
        { "command": "list.focusUp" },
      ]
    },
    "when": "listFocus && !inputFocus"
  },
  {
    "key": "shift+l",
    "command": "workbench.action.tasks.runTask",
    "args": "open-file-unfocus",
    "when": "explorerViewletVisible && filesExplorerFocus && !explorerResourceIsFolder && !inputFocus"
  },
  {
    "key": "l",
    "command": "vim.remap",
    "args": {
      "commands": [
        { "command": "explorer.openAndPassFocus" },
        { "command": "workbench.action.toggleSidebarVisibility" },
      ]
    },
    "when": "explorerViewletVisible && filesExplorerFocus && !explorerResourceIsFolder && !inputFocus"
  },
  {
    "key": "v",
    "command": "vim.remap",
    "args": {
      "commands": [
        { "command": "explorer.openToSide" },
        { "command": "workbench.action.toggleSidebarVisibility" },
      ]
    },
    "when": "explorerViewletFocus && explorerViewletVisible && !inputFocus"
  },
  { "key": "q", "command": "workbench.action.toggleSidebarVisibility", "when": "explorerViewletVisible && filesExplorerFocus && !inputFocus" },
  { "key": "z", "command": "workbench.files.action.collapseExplorerFolders", "when": "explorerViewletFocus && explorerViewletVisible && !inputFocus" },

  // Show UI
  { "key": "ctrl+\\", "command": "workbench.action.togglePanel" },
  { "key": "alt+space", "command": "whichkey.show" },
  { "key": "space", "command": "whichkey.show", "when": "editorTextFocus && vim.mode == 'Normal'" },

  // References Navigation
  { "key": "alt+n", "command": "editor.action.wordHighlight.next" },
  { "key": "alt+p", "command": "editor.action.wordHighlight.prev" },

  // Copy Paste
  { "key": "alt+c", "command": "editor.action.clipboardCopyAction", "when": "!terminalFocus" },
  { "key": "alt+v", "command": "editor.action.clipboardPasteAction", "when": "!terminalFocus" },
  { "key": "alt+c", "command": "workbench.action.terminal.copySelection", "when": "terminalFocus" },
  { "key": "alt+v", "command": "workbench.action.terminal.paste", "when": "terminalFocus" },

  // Escape Navigation
  { "key": "alt+h", "command": "vim.remap", "when": "inputFocus && vim.mode != 'Normal'", "args": { "after": [ "<esc>", "h" ] } },
  { "key": "alt+j", "command": "vim.remap", "when": "inputFocus && vim.mode != 'Normal'", "args": { "after": [ "<esc>", "j" ] } },
  { "key": "alt+k", "command": "vim.remap", "when": "inputFocus && vim.mode != 'Normal'", "args": { "after": [ "<esc>", "k" ] } },
  { "key": "alt+l", "command": "vim.remap", "when": "inputFocus && vim.mode != 'Normal'", "args": { "after": [ "<esc>", "l" ] } },

  // Buffer Navigation
  { "key": "ctrl+;", "command": "vim.remap", "when": "!terminalFocus", "args": { "after": [ "<C-6>" ] } },
  { "key": "alt+s", "command": "workbench.action.previousEditor", "when": "!terminalFocus", },
  { "key": "alt+f", "command": "workbench.action.nextEditor", "when": "!terminalFocus", },

  // Buffer Move
  { "key": "alt+shift+s", "command": "workbench.action.moveEditorLeftInGroup", "when": "!terminalFocus" },
  { "key": "alt+shift+f", "command": "workbench.action.moveEditorRightInGroup", "when": "!terminalFocus" },

  // Tmux-like
  { "key": "ctrl+b 1", "command": "workbench.action.terminal.focusAtIndex1", "when": "terminalFocus" },
  { "key": "ctrl+b 2", "command": "workbench.action.terminal.focusAtIndex2", "when": "terminalFocus" },
  { "key": "ctrl+b 3", "command": "workbench.action.terminal.focusAtIndex3", "when": "terminalFocus" },
  { "key": "ctrl+b 4", "command": "workbench.action.terminal.focusAtIndex4", "when": "terminalFocus" },
  { "key": "ctrl+b 5", "command": "workbench.action.terminal.focusAtIndex5", "when": "terminalFocus" },
  { "key": "ctrl+b 6", "command": "workbench.action.terminal.focusAtIndex6", "when": "terminalFocus" },
  { "key": "ctrl+b 7", "command": "workbench.action.terminal.focusAtIndex7", "when": "terminalFocus" },
  { "key": "ctrl+b 8", "command": "workbench.action.terminal.focusAtIndex8", "when": "terminalFocus" },
  { "key": "ctrl+b 9", "command": "workbench.action.terminal.focusAtIndex9", "when": "terminalFocus" },
  { "key": "ctrl+b c", "command": "workbench.action.terminal.newInActiveWorkspace", "when": "terminalFocus" },
  { "key": "ctrl+b ctrl+b", "command": "workbench.action.toggleSidebarVisibility", "when": "terminalFocus" },
  { "key": "ctrl+b n", "command": "workbench.action.terminal.focusNext", "when": "terminalFocus" },
  { "key": "ctrl+b p", "command": "workbench.action.terminal.focusPrevious", "when": "terminalFocus" },
  { "key": "ctrl+alt+n", "command": "workbench.action.terminal.focusNext", "when": "terminalFocus" },
  { "key": "ctrl+alt+p", "command": "workbench.action.terminal.focusPrevious", "when": "terminalFocus" },
  { "key": "ctrl+b v", "command": "workbench.action.terminal.split", "when": "terminalFocus" },
  { "key": "ctrl+b shift+v", "command": "workbench.action.terminal.split", "when": "terminalFocus" },
  { "key": "ctrl+b w", "command": "workbench.action.quickOpenTerm", "when": "terminalFocus" },
  { "key": "ctrl+b x", "command": "workbench.action.terminal.kill", "when": "terminalFocus" },
  { "key": "ctrl+b z", "command": "workbench.action.toggleMaximizedPanel", "when": "terminalFocus" },
  { "key": "ctrl+alt+l", "command": "workbench.action.terminal.clear", "when": "terminalFocus" },
  { "key": "ctrl+b h", "command": "workbench.action.terminal.focusPreviousPane", "when": "terminalFocus" },
  { "key": "ctrl+b j", "command": "workbench.action.terminal.focusNextPane", "when": "terminalFocus" },
  { "key": "ctrl+b k", "command": "workbench.action.terminal.focusPreviousPane", "when": "terminalFocus" },
  { "key": "ctrl+b l", "command": "workbench.action.terminal.focusNextPane", "when": "terminalFocus" },
  { "key": "ctrl+left", "command": "workbench.action.terminal.focusPreviousPane", "when": "terminalFocus" },
  { "key": "ctrl+right", "command": "workbench.action.terminal.focusNextPane", "when": "terminalFocus" },
  { "key": "ctrl+up", "command": "workbench.action.terminal.focusPreviousPane", "when": "terminalFocus" },
  { "key": "ctrl+down", "command": "workbench.action.terminal.focusNextPane", "when": "terminalFocus" },
  { "key": "ctrl+b alt+up", "command": "workbench.action.terminal.resizePaneUp", "when": "terminalFocus" },
  { "key": "ctrl+b alt+down", "command": "workbench.action.terminal.resizePaneDown", "when": "terminalFocus" },
  { "key": "ctrl+b alt+left", "command": "workbench.action.terminal.resizePaneLeft", "when": "terminalFocus" },
  { "key": "ctrl+b alt+right", "command": "workbench.action.terminal.resizePaneRight", "when": "terminalFocus" },
  { "key": "ctrl+alt+left", "command": "workbench.action.terminal.resizePaneLeft", "when": "terminalFocus" },
  { "key": "ctrl+alt+right", "command": "workbench.action.terminal.resizePaneRight", "when": "terminalFocus" },
  { "key": "ctrl+alt+down", "command": "workbench.action.terminal.resizePaneDown", "when": "terminalFocus" },
  { "key": "ctrl+alt+up", "command": "workbench.action.terminal.resizePaneUp", "when": "terminalFocus" },

  // Terminal buffer-scrollback
  {
    "key": "ctrl+alt+a",
    "command": "runCommands",
    "args": {
      "commands": [
        { "command": "workbench.action.terminal.selectAll", },
        { "command": "editor.action.clipboardCopyAction" },
        { "command": "workbench.action.files.newUntitledFile" },
        { "command": "editor.action.clipboardPasteAction" }
      ]
    }
  },

  // Terminal copy-mode
  { "key": "ctrl+alt+space", "command": "workbench.action.terminal.focusAccessibleBuffer", "when": "terminalFocus" },

  // Terminal Scrolling-Navigation
  { "key": "alt+d", "command": "workbench.action.terminal.scrollDown", "when": "terminalFocus" },
  { "key": "alt+e", "command": "workbench.action.terminal.scrollUp", "when": "terminalFocus" },
  { "key": "alt+q", "command": "workbench.action.terminal.scrollUpPage", "when": "terminalFocus" },
  { "key": "alt+a", "command": "workbench.action.terminal.scrollDownPage", "when": "terminalFocus" },
  { "key": "alt+t", "command": "workbench.action.terminal.scrollToTop", "when": "terminalFocus" },
  { "key": "alt+g", "command": "workbench.action.terminal.scrollToBottom", "when": "terminalFocus" },
  { "key": "alt+w", "command": "workbench.action.terminal.scrollToPreviousCommand", "when": "terminalFocus" },
  { "key": "alt+r", "command": "workbench.action.terminal.scrollToNextCommand", "when": "terminalFocus" },
  { "key": "alt+s", "command": "workbench.action.terminal.focusPrevious", "when": "terminalFocus" },
  { "key": "alt+f", "command": "workbench.action.terminal.focusNext", "when": "terminalFocus" },

  // Terminal Resize
  { "key": "alt+left", "command": "workbench.action.terminal.resizePaneLeft", "when": "terminalFocus" },
  { "key": "alt+right", "command": "workbench.action.terminal.resizePaneRight", "when": "terminalFocus" },
  { "key": "alt+down", "command": "workbench.action.terminal.resizePaneDown", "when": "terminalFocus" },
  { "key": "alt+up", "command": "workbench.action.terminal.resizePaneUp", "when": "terminalFocus" },

  // Window Resize
  { "key": "alt+left", "command": "vim.remap", "args": { "after": [ "<C-w>", "<" ] }, "when": "!terminalFocus" },
  { "key": "alt+down", "command": "vim.remap", "args": { "after": [ "<C-w>", "-" ] }, "when": "!terminalFocus" },
  { "key": "alt+up", "command": "vim.remap", "args": { "after": [ "<C-w>", "+" ] }, "when": "!terminalFocus" },
  { "key": "alt+right", "command": "vim.remap", "args": { "after": [ "<C-w>", ">" ] }, "when": "!terminalFocus" },

  // Window Navigation
  { "key": "ctrl+h", "command": "workbench.action.navigateLeft", "when": "vim.mode == 'Normal'", },
  { "key": "ctrl+j", "command": "workbench.action.navigateDown", "when": "vim.mode == 'Normal'", },
  { "key": "ctrl+k", "command": "workbench.action.navigateUp", "when": "vim.mode == 'Normal'", },
  { "key": "ctrl+l", "command": "workbench.action.navigateRight", "when": "vim.mode == 'Normal'", },

  // Toggle ParameterHints (vim.mode=='Normal' -> <C-p>:GoToFile, gH:triggerParameterHints)
  { "key": "ctrl+p", "command": "editor.action.triggerParameterHints", "when": "editorFocus && editorHasSignatureHelpProvider && vim.mode == 'Insert'" },
  { "key": "ctrl+p", "command": "closeParameterHints", "when": "editorFocus && parameterHintsVisible && vim.mode == 'Insert'" },

  // Toggle Completion
  { "key": "ctrl+space", "command": "editor.action.triggerSuggest", "when": "!suggestWidgetVisible && textInputFocus" },
  { "key": "ctrl+space", "command": "hideSuggestWidget", "when": "suggestWidgetVisible && textInputFocus" },

  // Completion Navigation (pgdown/pgup scrolls suggestion's preview focused)
  { "key": "ctrl+shift+space", "command": "toggleSuggestionFocus", "when": "suggestWidgetVisible && textInputFocus" },
  { "key": "alt+j", "command": "editor.action.inlineSuggest.showNext", "when": "inlineSuggestionVisible && vim.mode == 'Insert'" },
  { "key": "alt+k", "command": "editor.action.inlineSuggest.showPrevious", "when": "inlineSuggestionVisible && vim.mode == 'Insert'" },
  { "key": "alt+l", "command": "editor.action.inlineSuggest.commit", "when": "inlineSuggestionVisible && vim.mode == 'Insert'" },
  { "key": "ctrl+j", "command": "selectNextSuggestion", "when": "editorTextFocus && suggestWidgetMultipleSuggestions && suggestWidgetVisible" },
  { "key": "ctrl+k", "command": "selectPrevSuggestion", "when": "editorTextFocus && suggestWidgetMultipleSuggestions && suggestWidgetVisible" },
  { "key": "ctrl+l", "command": "acceptSelectedSuggestion", "when": "acceptSuggestionOnEnter && suggestWidgetHasFocusedSuggestion && suggestWidgetVisible && suggestionMakesTextEdit && textInputFocus" },
  { "key": "tab", "command": "selectNextSuggestion", "when": "!terminalFocus && editorTextFocus && suggestWidgetMultipleSuggestions && suggestWidgetVisible" },
  { "key": "shift+tab", "command": "selectPrevSuggestion", "when": "!terminalFocus && editorTextFocus && suggestWidgetMultipleSuggestions && suggestWidgetVisible" },

  // QuickOpen Navigation
  { "key": "alt+;", "command": "workbench.action.quickOpenPreviousRecentlyUsedEditorInGroup", "when": "!activeEditorGroupEmpty" },
  { "key": "alt+;", "command": "workbench.action.quickOpenNavigateNext", "when": "inQuickOpen" },
  { "key": "alt+shift+;", "command": "workbench.action.quickOpenLeastRecentlyUsedEditorInGroup", "when": "!activeEditorGroupEmpty" },
  { "key": "alt+shift+;", "command": "workbench.action.quickOpenNavigatePrevious", "when": "inQuickOpen" },
  { "key": "ctrl+j", "command": "workbench.action.quickOpenNavigateNext", "when": "inQuickOpen" },
  { "key": "ctrl+k", "command": "workbench.action.quickOpenNavigatePrevious", "when": "inQuickOpen" },
  { "key": "tab", "command": "workbench.action.quickOpenNavigateNext", "when": "!terminalFocus && inQuickOpen" },
  { "key": "shift+tab", "command": "workbench.action.quickOpenNavigatePrevious", "when": "!terminalFocus && inQuickOpen" },

  // Buffer Navigation
  { "key": "tab", "command": "workbench.action.nextEditor", "when": "!terminalFocus && !sideBarFocus && vim.mode == 'Normal' && editorFocus", },
  { "key": "shift+tab", "command": "workbench.action.previousEditor", "when": "!terminalFocus && !sideBarFocus && vim.mode == 'Normal' && editorFocus", },
  { "key": "right", "command": "workbench.action.nextEditor", "when": "!terminalFocus && !sideBarFocus && vim.mode == 'Normal' && editorFocus", },
  { "key": "left", "command": "workbench.action.previousEditor", "when": "!terminalFocus && !sideBarFocus && vim.mode == 'Normal' && editorFocus", },
  { "key": "ctrl+tab", "command": "workbench.action.nextEditor" },
  { "key": "ctrl+shift+tab", "command": "workbench.action.previousEditor" },

  // Find/Search (conflicting keymaps)
  { "key": "alt+w", "command": "-workbench.action.terminal.toggleFindWholeWord", "when": "terminalFindFocused && terminalHasBeenCreated || terminalFindFocused && terminalProcessSupported || terminalFocus && terminalHasBeenCreated || terminalFocus && terminalProcessSupported" },
  { "key": "alt+r", "command": "-workbench.action.terminal.toggleFindRegex", "when": "terminalFindFocused && terminalHasBeenCreated || terminalFindFocused && terminalProcessSupported || terminalFocus && terminalHasBeenCreated || terminalFocus && terminalProcessSupported" },

  // Tmux navigation (conflicting keymaps)
  { "key": "ctrl+up", "command": "-workbench.action.terminal.scrollToPreviousCommand", "when": "terminalFocus && terminalHasBeenCreated && !accessibilityModeEnabled || terminalFocus && terminalProcessSupported && !accessibilityModeEnabled" },
  { "key": "ctrl+down", "command": "-workbench.action.terminal.scrollToNextCommand", "when": "terminalFocus && terminalHasBeenCreated && !accessibilityModeEnabled || terminalFocus && terminalProcessSupported && !accessibilityModeEnabled" },

  // Insert Tab (conflicting keymaps)
  { "key": "tab", "command": "-editor.action.inlineSuggest.commit", "when": "inlineSuggestionHasIndentationLessThanTabSize && inlineSuggestionVisible && !editorTabMovesFocus" },
  { "key": "tab", "command": "-editor.action.inlineSuggest.commit", "when": "editorFocus && inlineSuggestionVisible && !editorReadonly" }
]
